<!-- Elements added to main will be displayed on all pages --><!DOCTYPE html><html lang="fr" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://cybercentrecanada.github.io/clue/fr/developer/plugin/">
      
      
        <link rel="prev" href="../getting_started/">
      
      
        <link rel="next" href="../backend/">
      
      
        
          <link rel="alternate" href="../../../developer/plugin/" hreflang="en">
        
          <link rel="alternate" href="./" hreflang="fr">
        
      
      
      <link rel="icon" href="../../../images/clue-icon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Creating a new Clue Plugin - Clue</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="dark" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#creating-a-new-clue-plugin" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href="../../" title="Clue" class="md-header__button md-logo" aria-label="Clue" data-md-component="logo">
      
  <img src="../../../images/clue-icon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Clue
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Creating a new Clue Plugin
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="dark" data-md-color-primary="custom" data-md-color-accent="indigo" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="custom" data-md-color-accent="indigo" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Sélectionner la langue">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"></path></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../../developer/plugin/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="fr" class="md-select__link">
              Français
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Recherche">
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/CybercentreCanada/clue" title="Aller au dépôt" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Onglets" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../" class="md-tabs__link">
        
  
  
    
  
  Accueil

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../overview/users/" class="md-tabs__link">
          
  
  
  Aperçu

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../installation/helm/" class="md-tabs__link">
          
  
  
  Installation

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../getting_started/" class="md-tabs__link">
          
  
  
  Guide du développeur

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../" title="Clue" class="md-nav__button md-logo" aria-label="Clue" data-md-component="logo">
      
  <img src="../../../images/clue-icon.svg" alt="logo">

    </a>
    Clue
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/CybercentreCanada/clue" title="Aller au dépôt" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accueil
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2">
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Aperçu
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Aperçu
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1">
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Fonctionnement
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Fonctionnement
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/users/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Clue From The User's Perspective
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/plugin_developers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Clue From The Plugin Developer's Perspective
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Clue From The Integrator's Perspective
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3">
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Installation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/helm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes Deployment Guide (using Helm)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/plugin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plugin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Guide du développeur
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guide du développeur
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Creating a new Clue Plugin
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Creating a new Clue Plugin
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#development-environment-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Development Environment Setup
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Development Environment Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-poetry" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing poetry
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installing poetry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#useful-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        Useful Commands
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-clue-folders-and-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setup Clue Folders and Configuration
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-the-plugin" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating the plugin
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interacting-with-the-central-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interacting with the central API
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Interacting with the central API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request-initiation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Request Initiation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response" class="md-nav__link">
    <span class="md-ellipsis">
      
        Response
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#valid-plugin-operations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Valid Plugin Operations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Valid Plugin Operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enrichment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enrichment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Actions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Actions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Additional Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#action-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        Action Results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetchers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fetchers
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-the-docker-image" class="md-nav__link">
    <span class="md-ellipsis">
      
        Building the docker image
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backend/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Clue API Development Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frontend/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Clue UI Development Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CONTRIBUTING
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#development-environment-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Development Environment Setup
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Development Environment Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-poetry" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing poetry
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installing poetry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#useful-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        Useful Commands
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-clue-folders-and-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setup Clue Folders and Configuration
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-the-plugin" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating the plugin
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interacting-with-the-central-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interacting with the central API
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Interacting with the central API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request-initiation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Request Initiation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response" class="md-nav__link">
    <span class="md-ellipsis">
      
        Response
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#valid-plugin-operations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Valid Plugin Operations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Valid Plugin Operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enrichment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enrichment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Actions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Actions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Additional Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#action-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        Action Results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetchers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fetchers
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-the-docker-image" class="md-nav__link">
    <span class="md-ellipsis">
      
        Building the docker image
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="creating-a-new-clue-plugin">Creating a new Clue Plugin<a class="headerlink" href="#creating-a-new-clue-plugin" title="Permanent link">¶</a></h1>
<p>This document will walk you through developing, publishing and deploying a new Clue plugin.</p>
<h2 id="development-environment-setup">Development Environment Setup<a class="headerlink" href="#development-environment-setup" title="Permanent link">¶</a></h2>
<h3 id="installing-poetry">Installing poetry<a class="headerlink" href="#installing-poetry" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>poetry
<span class="nb">cd</span><span class="w"> </span>clue-api
poetry<span class="w"> </span>install<span class="w"> </span>--with<span class="w"> </span>dev,test<span class="w"> </span>--all-extras

<span class="c1"># OPTIONAL: Instead pre-commit hooks (black/flake8/isort formatting)</span>
poetry<span class="w"> </span>run<span class="w"> </span>pre-commit<span class="w"> </span>install

<span class="c1"># Now you can run the clue server!</span>
poetry<span class="w"> </span>run<span class="w"> </span>server
</code></pre></div>
<h4 id="useful-commands">Useful Commands<a class="headerlink" href="#useful-commands" title="Permanent link">¶</a></h4>
<p>To activate a venv, use <strong><code>poetry shell</code></strong>.</p>
<p>To add a new dependency, use <strong><code>poetry add</code></strong>:</p>
<div class="highlight"><pre><span></span><code>➜<span class="w">  </span>clue-api<span class="w"> </span>git:<span class="o">(</span>poetry<span class="o">)</span><span class="w"> </span>poetry<span class="w"> </span>add<span class="w"> </span>pyjwt
Using<span class="w"> </span>version<span class="w"> </span>^2.8.0<span class="w"> </span><span class="k">for</span><span class="w"> </span>pyjwt

Updating<span class="w"> </span>dependencies
Resolving<span class="w"> </span>dependencies...<span class="w"> </span><span class="o">(</span><span class="m">0</span>.5s<span class="o">)</span>

Package<span class="w"> </span>operations:<span class="w"> </span><span class="m">1</span><span class="w"> </span>install,<span class="w"> </span><span class="m">0</span><span class="w"> </span>updates,<span class="w"> </span><span class="m">0</span><span class="w"> </span>removals

<span class="w">  </span>-<span class="w"> </span>Installing<span class="w"> </span>pyjwt<span class="w"> </span><span class="o">(</span><span class="m">2</span>.8.0<span class="o">)</span>

Writing<span class="w"> </span>lock<span class="w"> </span>file
</code></pre></div>
<p>Then commit the new <code>pyproject.toml</code> and <code>poetry.lock</code>.</p>
<h3 id="setup-clue-folders-and-configuration">Setup Clue Folders and Configuration<a class="headerlink" href="#setup-clue-folders-and-configuration" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Clue config.yml should be in this location, as well as classification.yml</span>
<span class="c1"># For a starter config, use the test config.yml and classification.</span>
sudo<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/etc/clue/conf
<span class="c1"># Log file directory, will write log files here if enabled</span>
sudo<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/var/log/clue

sudo<span class="w"> </span>chown<span class="w"> </span>-R<span class="w"> </span><span class="nv">$USER</span><span class="w"> </span>/etc/clue
sudo<span class="w"> </span>chown<span class="w"> </span><span class="nv">$USER</span><span class="w"> </span>/var/log/clue
</code></pre></div>
<h2 id="creating-the-plugin">Creating the plugin<a class="headerlink" href="#creating-the-plugin" title="Permanent link">¶</a></h2>
<p>The easiest way to create a plugin is to use the Interactive Wizard. This script can be found at plugins/setup/create.py
Simply run the python script and it will prompt you for required info:
</p><div class="highlight"><pre><span></span><code>python<span class="w"> </span>plugins/setup/create.py
</code></pre></div><p></p>
<h2 id="interacting-with-the-central-api">Interacting with the central API<a class="headerlink" href="#interacting-with-the-central-api" title="Permanent link">¶</a></h2>
<h3 id="request-initiation">Request Initiation<a class="headerlink" href="#request-initiation" title="Permanent link">¶</a></h3>
<p>Various client applications can make requests to the central API, which will in turn proxy requests to every relevant registered plugin.</p>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="https://mermaid.ink/img/pako:eNqFkk9PwkAQxb_KZrxoAgfg1oMJCokcTIjIRcphbId24_6p012RAN_dpaWxpqJ7mjf5vZmX7OwhsSlBBBtlt0mO7MTzJDYivAe7VcTL2aouxHK2Fv3-7WFqWCa5JuPEE717Kt3hzNa-cVmSflU7JQ0Fd1v-OaMNthM0-8fz2iwWxB_E1_fBzajEnWVCJcsTcNON8DNAM-TXBP8ProkqxVz5TJrBavqJulB01uJqsL6ADjvo8BI66qCjCoUeaGKNMg0_tj91YnA5aYohCmWK_BZDbI6BQ-_sYmcSiBx76gFbn-WN8EWKjiYSM0YN0QZVGboFmhdrvzWl0ll-rO-jOpPjF8rrveU?type=png" data-desc-position="bottom"><img alt="Request Initiation Diagram" src="https://mermaid.ink/img/pako:eNqFkk9PwkAQxb_KZrxoAgfg1oMJCokcTIjIRcphbId24_6p012RAN_dpaWxpqJ7mjf5vZmX7OwhsSlBBBtlt0mO7MTzJDYivAe7VcTL2aouxHK2Fv3-7WFqWCa5JuPEE717Kt3hzNa-cVmSflU7JQ0Fd1v-OaMNthM0-8fz2iwWxB_E1_fBzajEnWVCJcsTcNON8DNAM-TXBP8ProkqxVz5TJrBavqJulB01uJqsL6ADjvo8BI66qCjCoUeaGKNMg0_tj91YnA5aYohCmWK_BZDbI6BQ-_sYmcSiBx76gFbn-WN8EWKjiYSM0YN0QZVGboFmhdrvzWl0ll-rO-jOpPjF8rrveU?type=png"></a></p>
<h3 id="response">Response<a class="headerlink" href="#response" title="Permanent link">¶</a></h3>
<p>The responses from each plugin are then merged together and returned with some metadata to the client application.</p>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="https://mermaid.ink/img/pako:eNqNkjFvwjAQhf-K5S6tBAPJlqESBaQyVEKlLCUMp_iSWLV90cUprQj_vYYEAaIDXnzv-d2nk847mZFCmcjc0DYrgb34mKZOhLMwTaHdaD37AVsZ7LV4GG3EcPjczhzrrLTovBg7Rx68JleLnPicbMUS-Rv5EhjdAKO7gdF_wPgGGN8NjK-BXf04CS0MRrwQIxhdi_Fi_nRETgKAjFbgUYkL_jvWVXjCVrzS1iCvu-vQuOnQvREgfbman0KrLiMH0iJb0CqsY3dwUulLtJjKJJQK-CuVqduHHDSelr8uk4nnBgeSqSnKk2iqw3hTDQWDlUkOpg5uBe6T6KxRaU_81i3_-Af2f73PsxQ?type=png" data-desc-position="bottom"><img alt="Response Explanation" src="https://mermaid.ink/img/pako:eNqNkjFvwjAQhf-K5S6tBAPJlqESBaQyVEKlLCUMp_iSWLV90cUprQj_vYYEAaIDXnzv-d2nk847mZFCmcjc0DYrgb34mKZOhLMwTaHdaD37AVsZ7LV4GG3EcPjczhzrrLTovBg7Rx68JleLnPicbMUS-Rv5EhjdAKO7gdF_wPgGGN8NjK-BXf04CS0MRrwQIxhdi_Fi_nRETgKAjFbgUYkL_jvWVXjCVrzS1iCvu-vQuOnQvREgfbman0KrLiMH0iJb0CqsY3dwUulLtJjKJJQK-CuVqduHHDSelr8uk4nnBgeSqSnKk2iqw3hTDQWDlUkOpg5uBe6T6KxRaU_81i3_-Af2f73PsxQ?type=png"></a></p>
<h2 id="valid-plugin-operations">Valid Plugin Operations<a class="headerlink" href="#valid-plugin-operations" title="Permanent link">¶</a></h2>
<h3 id="enrichment">Enrichment<a class="headerlink" href="#enrichment" title="Permanent link">¶</a></h3>
<p>Enrichments are a bread and butter of Clue. This entails the user requesting enrichment information about a given
selector by making a network call to the central API, like this:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Enriching a single selector</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">/api/v1/lookup/enrich/ip/127.0.0.1"</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">"max_timeout"</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">},</span>
    <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">"Authorization"</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"Bearer </span><span class="si">{</span><span class="n">access_token</span><span class="si">}</span><span class="s2">"</span><span class="p">},</span>
<span class="p">)</span>

<span class="c1"># Bulk enrichment of selectors</span>
<span class="n">bulk_req</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">"type"</span><span class="p">:</span> <span class="s2">"ip"</span><span class="p">,</span> <span class="s2">"value"</span><span class="p">:</span> <span class="s2">"127.0.0.1"</span><span class="p">},</span> <span class="p">{</span><span class="s2">"type"</span><span class="p">:</span> <span class="s2">"ip"</span><span class="p">,</span> <span class="s2">"value"</span><span class="p">:</span> <span class="s2">"127.0.0.2"</span><span class="p">}]</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">/api/v1/lookup/enrich"</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">"max_timeout"</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span> <span class="s2">"sources"</span><span class="p">:</span> <span class="s2">"test|bad"</span><span class="p">},</span>
    <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">"Authorization"</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"Bearer </span><span class="si">{</span><span class="n">access_token</span><span class="si">}</span><span class="s2">"</span><span class="p">},</span>
    <span class="n">json</span><span class="o">=</span><span class="n">bulk_req</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<p>For a single enrichment, the response body will be a <code>QueryResult</code>:</p>
<details>
<summary>QueryResult Example</summary>

<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ip"</span><span class="p">,</span>
<span class="w">  </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"127.0.0.1"</span><span class="p">,</span>
<span class="w">  </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example_plugin"</span><span class="p">,</span>
<span class="w">  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">"classification"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TLP:CLEAR"</span><span class="p">,</span>
<span class="w">      </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">23</span><span class="p">,</span>
<span class="w">      </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://example.com/moreinfo"</span><span class="p">,</span>
<span class="w">      </span><span class="nt">"annotations"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">"analytic"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Assemblyline"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"analytic_icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"material-symbols:sound-detection-dog-barking"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"author"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2024-12-16T12:54:26.374945+00:00"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"context"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"suspect"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"confidence"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"severity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="mf">50.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example summary of the information in this Annotation"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"# Here's some annotation details\\n\\nIt's very interesting"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://example.com/annotation"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"ubiquitous"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">"analytic"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Howler"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"analytic_icon"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"author"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v0.0.1"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2024-12-30T12:54:26.374940+00:00"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"context"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"benign"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"confidence"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"severity"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="mf">50.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example summary of the information in this Annotation"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"details"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://example.com/annotation"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"ubiquitous"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">"analytic"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Assemblyline"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"analytic_icon"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Smith"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2024-12-30T12:54:26.374940+00:00"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mitigation"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="mf">42.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"confidence"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"severity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="mf">50.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example summary of the information in this Annotation"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"# Here's some annotation details\\n\\nIt's very interesting"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"ubiquitous"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">      </span><span class="nt">"raw_data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">"raw_field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some_data"</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">"classification"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TLP:CLEAR"</span><span class="p">,</span>
<span class="w">      </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span>
<span class="w">      </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nt">"annotations"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">"analytic"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Howler"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"analytic_icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"material-symbols:sound-detection-dog-barking"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"author"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2024-12-16T12:54:26.374945+00:00"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"frequency"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="mf">42.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"confidence"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"severity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="mf">50.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example summary of the information in this Annotation"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"details"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://example.com/annotation"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"ubiquitous"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">"analytic"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"analytic_icon"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Smith"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v0.0.1"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2024-12-30T12:54:26.374940+00:00"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"context"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Involved in Operation Cat"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"confidence"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"severity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example summary of the information in this Annotation"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"details"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://example.com/annotation"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"ubiquitous"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">      </span><span class="nt">"raw_data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"other_data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"other_row"</span><span class="p">:</span><span class="w"> </span><span class="mi">45</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">"classification"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TLP:CLEAR"</span><span class="p">,</span>
<span class="w">      </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">23</span><span class="p">,</span>
<span class="w">      </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://example.com/moreinfo"</span><span class="p">,</span>
<span class="w">      </span><span class="nt">"annotations"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">"analytic"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Howler"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"analytic_icon"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Smith"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v0.0.1"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2024-12-30T12:54:26.374940+00:00"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"context"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Involved in Operation Cat"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"confidence"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"severity"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="mf">1000.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example summary of the information in this Annotation"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"details"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"ubiquitous"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">"analytic"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"analytic_icon"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"author"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2024-12-16T12:54:26.374945+00:00"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"frequency"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="mf">42.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"confidence"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"severity"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="mf">1000.0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example summary of the information in this Annotation"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"# Here's some annotation details\\n\\nIt's very interesting"</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">"ubiquitous"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">      </span><span class="nt">"raw_data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">"raw_field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some_data"</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">"maintainer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">"datahub_link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://example.com/datahub"</span><span class="p">,</span>
<span class="w">  </span><span class="nt">"documentation_link"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">"latency"</span><span class="p">:</span><span class="w"> </span><span class="mi">1470</span>
<span class="p">}</span>
</code></pre></div>

</details>

<p>A bulk enrichment will return the data in a dict of dicts of a list of <code>QueryResult</code>s, where the first key is the type
and the second key is the value:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">"ip"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">"127.0.0.1"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="c1">// See above for a full query result example</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ip"</span><span class="p">,</span>
<span class="w">                </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"127.0.0.1"</span><span class="p">,</span>
<span class="w">                </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example_plugin"</span><span class="p">,</span>
<span class="w">                </span><span class="err">...</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>However, this formatting is handled by the central API and the Clue plugin for the most part.</p>
<h3 id="actions">Actions<a class="headerlink" href="#actions" title="Permanent link">¶</a></h3>
<p>Actions are operations a plugin can perform on either a single or several selectors. For example, an action could add
a selector to a database somewhere for tracking purposes, return a markdown summary of refined results for a set of
selectors, or any other arbitrary action. Clue only enforces the format of the response - there are no restrictions
on what an action can do.</p>
<p>In order to execute an action, the user must send an execution request to the central API:</p>
<div class="highlight"><pre><span></span><code><span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">/api/v1/actions/execute/example/example_action"</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">"max_timeout"</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">},</span>
    <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">"Authorization"</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"Bearer </span><span class="si">{</span><span class="n">access_token</span><span class="si">}</span><span class="s2">"</span><span class="p">},</span>
    <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s2">"selector"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"type"</span><span class="p">:</span> <span class="s2">"ip"</span><span class="p">,</span> <span class="s2">"value"</span><span class="p">:</span> <span class="s2">"127.0.0.1"</span><span class="p">},</span> <span class="s2">"other_choice"</span><span class="p">:</span> <span class="s2">"b"</span><span class="p">},</span>
<span class="p">)</span>
</code></pre></div>
<p>You'll note the additional field provided. We will explain that next.</p>
<h4 id="additional-parameters">Additional Parameters<a class="headerlink" href="#additional-parameters" title="Permanent link">¶</a></h4>
<p>Clue plugins that expose an action can request additional parameters from the user in order to provide context of
the action request to the plugin. These parameters can be declared on the plugin side, and the Clue UI library will
handle gathering the additional parameters.</p>
<p>Additional parameters are specified using Python Generics and class inheritance. Here is an example corresponding to
the above request:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Params</span><span class="p">(</span><span class="n">ExecuteRequest</span><span class="p">):</span>
    <span class="n">other_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Another field you should show"</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span>
    <span class="n">choice</span><span class="p">:</span> <span class="n">ChoiceEnum</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">ChoiceEnum</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">"Another choice for you"</span><span class="p">)</span>
    <span class="n">other_choice</span><span class="p">:</span> <span class="n">ChoiceEnum</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Another choice for you with no default"</span><span class="p">)</span>

<span class="n">plugin</span> <span class="o">=</span> <span class="n">CluePlugin</span><span class="p">(</span>
    <span class="o">...</span><span class="p">,</span>
    <span class="n">actions</span><span class="o">=</span><span class="p">[</span>
        <span class="n">Action</span><span class="p">[</span><span class="n">Params</span><span class="p">](</span>
            <span class="nb">id</span><span class="o">=</span><span class="s2">"test_action"</span><span class="p">,</span>
            <span class="n">action_icon</span><span class="o">=</span><span class="s2">"codicon:terminal"</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">"Test Action"</span><span class="p">,</span>
            <span class="n">classification</span><span class="o">=</span><span class="s2">"TLP:CLEAR"</span><span class="p">,</span>
            <span class="n">summary</span><span class="o">=</span><span class="s2">"Tester"</span><span class="p">,</span>
            <span class="n">supported_types</span><span class="o">=</span><span class="p">{</span><span class="s2">"ip"</span><span class="p">,</span> <span class="s2">"port"</span><span class="p">,</span> <span class="s2">"sha256"</span><span class="p">},</span>
            <span class="n">accept_multiple</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</code></pre></div>
<p>Note that parameters can be marked as optional, as is shown above - only <code>other_choice</code> is fully required.</p>
<h4 id="action-results">Action Results<a class="headerlink" href="#action-results" title="Permanent link">¶</a></h4>
<p>In order to notify the user on the outcome of the action, actions are expected to return an <code>ActionResult</code> model. This
allows for a short description of the outcome, the output of the action (along with a format) as well as a status enum:</p>
<div class="highlight"><pre><span></span><code><span class="n">failed_example</span> <span class="o">=</span> <span class="n">ActionResult</span><span class="p">(</span>
    <span class="n">outcome</span><span class="o">=</span><span class="s2">"failure"</span><span class="p">,</span>
    <span class="n">summary</span><span class="o">=</span><span class="s2">"Action failed."</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="s2">"markdown"</span><span class="p">,</span>
    <span class="n">output</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">        # Action Failed</span>

<span class="s2">        Retaining your data was unsuccessful for an unknown reason.</span>

<span class="s2">        ## Error Message:</span>

<span class="s2">        </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        """</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="n">success_example</span> <span class="o">=</span> <span class="n">ActionResult</span><span class="p">(</span>
    <span class="n">outcome</span><span class="o">=</span><span class="s2">"success"</span><span class="p">,</span>
    <span class="n">summary</span><span class="o">=</span><span class="s2">"Action Completed Successfully"</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="s2">"json"</span><span class="p">,</span>
    <span class="n">output</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">"example"</span><span class="p">:</span> <span class="s2">"result"</span>
    <span class="p">},</span>
    <span class="n">link</span><span class="o">=</span><span class="n">Url</span><span class="p">(</span><span class="s2">"http://example.com"</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="fetchers">Fetchers<a class="headerlink" href="#fetchers" title="Permanent link">¶</a></h3>
<p>Fetchers are a way for plugins to return data to the client to be displayed based on a selector. This data can be
returned in any support format - currently:</p>
<ul>
<li>Markdown</li>
<li>Json</li>
<li>Images</li>
</ul>
<p>Fetchers function similarly to actions, except no additional information can be provided. Below is an example of a
fetcher implementation:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_fetcher</span><span class="p">(</span><span class="n">fetcher</span><span class="p">:</span> <span class="n">FetcherDefinition</span><span class="p">,</span> <span class="n">selector</span><span class="p">:</span> <span class="n">Selector</span><span class="p">,</span> <span class="n">access_token</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetcherResult</span><span class="p">:</span>
    <span class="s2">"Fetch a rendering of the given email"</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">access_token</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">FetcherResult</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="s2">"failure"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"error"</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="s2">"Missing access token."</span><span class="p">)</span>

            <span class="c1"># work here</span>

            <span class="k">return</span> <span class="n">FetcherResult</span><span class="p">(</span>
                <span class="n">outcome</span><span class="o">=</span><span class="s2">"success"</span><span class="p">,</span>
                <span class="nb">format</span><span class="o">=</span><span class="s2">"image"</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">ImageResult</span><span class="p">(</span>
                    <span class="n">image</span><span class="o">=</span><span class="sa">f</span><span class="s2">"data:image/png;base64,</span><span class="si">{</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">image_data</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">"utf-8"</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                    <span class="n">alt</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Rendering of an image to do with the given selector"</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">"Error in run_fetcher"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">FetcherResult</span><span class="o">.</span><span class="n">error_result</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

<span class="n">plugin</span> <span class="o">=</span> <span class="n">CluePlugin</span><span class="p">(</span>
    <span class="o">...</span><span class="p">,</span>
    <span class="n">run_fetcher</span><span class="o">=</span><span class="n">run_fetcher</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<h2 id="building-the-docker-image">Building the docker image<a class="headerlink" href="#building-the-docker-image" title="Permanent link">¶</a></h2>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Retour en haut de la page
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.expand", "navigation.top"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js"></script>
      
        <script src="../../../js/tables.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": false, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>