{
  "properties": {
    "analytic": {
      "anyOf": [{ "type": "string" }, { "type": "null" }],
      "description": "Identifier for the analytic producing the knowledge. Mutually exclusive with author.",
      "examples": ["Howler", "Assemblyline", null],
      "title": "Analytic"
    },
    "analytic_icon": {
      "anyOf": [{ "type": "string" }, { "type": "null" }],
      "description": "Formatted string to present an icon for this analytic on the UI using iconify/react format: https://iconify.design/docs/icon-components/react/. External icons not yet supported",
      "examples": ["material-symbols:sound-detection-dog-barking", null],
      "title": "Analytic Icon"
    },
    "author": {
      "anyOf": [{ "type": "string" }, { "type": "null" }],
      "description": "The author providing the annotation. Mutually exclusive with analytic.",
      "examples": ["John Smith", null],
      "title": "Author"
    },
    "quantity": {
      "description": "Number of times this annotation was generated for the given indicator",
      "examples": [1, 10, 25],
      "title": "Quantity",
      "type": "integer"
    },
    "version": {
      "anyOf": [{ "type": "string" }, { "type": "null" }],
      "description": "The version of the API for the analytic that produced the knowledge",
      "examples": ["v0.0.1", "1.0.0", null],
      "title": "Version"
    },
    "timestamp": {
      "anyOf": [{ "format": "date-time", "type": "string" }, { "type": "null" }],
      "description": "A timestamp describing when the knowledge was generated.",
      "examples": ["2025-07-30T15:40:35.961958Z", "2025-07-16T15:40:35.961963Z"],
      "title": "Timestamp"
    },
    "type": {
      "description": "\\nWhat type of annotation is this?\\nOpinion (What type of activity is the selector associated with?):\\n    benign - authorized or harmless activity\\n    suspect - outlier activity without clear intent\\n    malicious - intended to cause harm\\n    obscure - why a reliable opinion might not be possible\\n\\nContext (Unopinionated facts)\\n    Examples:\\n    - Frequency of observation based on summaries\\n    - Account privileges\\n    - Sign-in characteristics\\n    - Geo-location\\n    - Domain ownership\\n    - Operation Label\\n\\nAssessment (An official position)\\n    Benign Alert Assessments:\\n    - Ambiguous\\n    - Security\\n    - Development\\n    - False-positive\\n    - Legitimate\\n\\n    Malicious Alert Assessments:\\n    - Trivial\\n    - Recon\\n    - Attempt\\n    - Compromise\\n    - Mitigated\\n\\nFrequency (A numeric value for the frequency a selector has been seen)\\n    Higher number - more common selector\\n    Lower number - less common selector\\n\\nMitigation (Suggested actions available to mitigate harm done by the selector)\\n    exempt - Selector cannot be mitigated, used for known safe selectors\\n    alertable - Selector can be alerted on\\n    blockable - Selector can be blocked\\n    shareable - Selector can be shared with partners/collaborators\\n    not-alertable - Selector cannot be alerted on\\n    not-blockable - Selector cannot be blocked\\n    not-shareable - Selector cannot be shared with partners/collaborators\\n",
      "enum": ["opinion", "frequency", "assessment", "mitigation", "context"],
      "examples": ["opinion", "frequency", "assessment", "mitigation", "context"],
      "title": "Type",
      "type": "string"
    },
    "value": {
      "anyOf": [{ "type": "string" }, { "type": "number" }, { "type": "integer" }],
      "description": "The value associated with the type.",
      "examples": [
        "benign",
        "suspect",
        "malicious",
        "obscure",
        "IP Located in Canada",
        "Involved in Operation Cat",
        11,
        42.0
      ],
      "title": "Value"
    },
    "confidence": {
      "description": "Self-reported confidence level of the annotation. 0.0 = not confident at all, 1.0 = absolute fact",
      "examples": [0.0, 0.5, 1.0],
      "maximum": 1.0,
      "minimum": 0.0,
      "title": "Confidence",
      "type": "number"
    },
    "severity": {
      "anyOf": [{ "maximum": 1.0, "minimum": 0.0, "type": "number" }, { "type": "null" }],
      "description": "Severity of the annotation, if accurate. 0.0 = not severe at all, 1.0 = extremely important",
      "examples": [0.0, 0.5, 1.0, null],
      "title": "Severity"
    },
    "priority": {
      "anyOf": [{ "type": "number" }, { "type": "null" }],
      "description": "What priority to assign to this annotation. Higher priority = more likely to be shown to analysts. Optional. If not provided, calculated based on confidence, severity and reliability.",
      "examples": [1.0, 50.0, 1000.0, null],
      "title": "Priority"
    },
    "summary": {
      "description": "A plaintext summary of the annotation.",
      "examples": ["Example summary of the information in this Annotation"],
      "title": "Summary",
      "type": "string"
    },
    "details": {
      "anyOf": [{ "type": "string" }, { "type": "null" }],
      "description": "detailed description of the annotation. Supports markdown formatting.",
      "examples": ["# Here's some annotation details\\n\\nIt's very interesting", null],
      "title": "Details"
    },
    "link": {
      "anyOf": [{ "format": "uri", "minLength": 1, "type": "string" }, { "type": "null" }],
      "description": "Link for more information about this specific annotation",
      "examples": ["https://example.com/annotation", null],
      "title": "Link"
    },
    "icon": {
      "anyOf": [{ "type": "string" }, { "type": "null" }],
      "description": "Formatted string to present an icon for this annotation on the UI using iconify/react format: https://iconify.design/docs/icon-components/react/. External icons not yet supported",
      "examples": ["material-symbols:sound-detection-dog-barking", null],
      "title": "Icon"
    },
    "ubiquitous": {
      "description": "Does this annotation show up on the vast majority of selectors (i.e. asset provenance, organization ownership/non-ownership of IP address)",
      "examples": [true, false],
      "title": "Ubiquitous",
      "type": "boolean"
    }
  },
  "required": ["type", "value", "confidence", "summary"],
  "title": "Annotation",
  "type": "object"
}
